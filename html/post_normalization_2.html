
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>post_normalization_2</title><meta name="generator" content="MATLAB 8.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-10-25"><meta name="DC.source" content="post_normalization_2.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1></h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Combine five videos together</a></li><li><a href="#2">Normalization all together</a></li><li><a href="#3">Seperate each video</a></li><li><a href="#4">Time Matching(generalize for ECG signals)</a></li><li><a href="#5">Generalization for Belt signal</a></li><li><a href="#6">Calculate the x(t)-x(t-stepsize)</a></li></ul></div><h2>Combine five videos together<a name="1"></a></h2><p>load(strcat(rootIn,'\DataSet\feature_cal_1.mat')); feature_cal_1=Feature; load(strcat(rootIn,'\DataSet\feature_ECG_1.mat')); feature_ECG_1=Feature; load(strcat(rootIn,'\DataSet\feature_BELT_1.mat')); feature_BELT_1=Feature;</p><p>load(strcat(rootIn,'\DataSet\feature_cal_2.mat')); feature_cal_2=Feature; load(strcat(rootIn,'\DataSet\feature_ECG_2.mat')); feature_ECG_2=Feature; load(strcat(rootIn,'\DataSet\feature_BELT_2.mat')); feature_BELT_2=Feature;</p><p>load(strcat(rootIn,'\DataSet\feature_cal_3.mat')); feature_cal_3=Feature; load(strcat(rootIn,'\DataSet\feature_ECG_3.mat')); feature_ECG_3=Feature; load(strcat(rootIn,'\DataSet\feature_BELT_3.mat')); feature_BELT_3=Feature;</p><p>load(strcat(rootIn,'\DataSet\feature_cal_4.mat')); feature_cal_4=Feature; load(strcat(rootIn,'\DataSet\feature_ECG_4.mat')); feature_ECG_4=Feature; load(strcat(rootIn,'\DataSet\feature_BELT_4.mat')); feature_BELT_4=Feature;</p><p>load(strcat(rootIn,'\DataSet\feature_cal_5.mat')); feature_cal_5=Feature; load(strcat(rootIn,'\DataSet\feature_ECG_5.mat')); feature_ECG_5=Feature; load(strcat(rootIn,'\DataSet\feature_BELT_5.mat')); feature_BELT_5=Feature;</p><h2>Normalization all together<a name="2"></a></h2><p>Normalization all together for m=1:NumberofSignalSelected     featureAll_cal{m}=[feature_cal_1{m,1};feature_cal_2{m,1};feature_cal_3{m,1};feature_cal_4{m,1};feature_cal_5{m,1}];     Media=featureAll_cal{m};     for j=2:num_signal_attributes+1         Media(:,j)=(Media(:,j)-min(Media(:,j)))./(max(Media(:,j))-min(Media(:,j)));     end     featureAll_cal{m}=Media; end</p><p>featureAll_ECG=[feature_ECG_1;feature_ECG_2;feature_ECG_3;feature_ECG_4;feature_ECG_5];     for j=2:Totalfeature+1        featureAll_ECG(:,j)=(featureAll_ECG(:,j)-min(featureAll_ECG(:,j)))./(max(featureAll_ECG(:,j))-min(featureAll_ECG(:,j)));     end</p><p>featureAll_BELT=[feature_BELT_1;feature_BELT_2;feature_BELT_3;feature_BELT_4;feature_BELT_5]; for j=2:Totalfeature+1        featureAll_BELT(:,j)=(featureAll_BELT(:,j)-min(featureAll_BELT(:,j)))./(max(featureAll_BELT(:,j))-min(featureAll_BELT(:,j))); end</p><h2>Seperate each video<a name="3"></a></h2><p>for j=1:NumberofSignalSelected     video=featureAll_cal{j};     video_cal_1{j}=[zeros(window_size_cal-1,num_signal_attributes+1);video((1:L_cal1),:)];     video_cal_2{j}=[zeros(window_size_cal-1,num_signal_attributes+1);video((L_cal1+1:L_cal2+L_cal1),:)];     video_cal_3{j}=[zeros(window_size_cal-1,num_signal_attributes+1);video((L_cal1+L_cal2+1:L_cal2+L_cal1+L_cal3),:)];     video_cal_4{j}=[zeros(window_size_cal-1,num_signal_attributes+1);video((L_cal1+L_cal2+L_cal3+1:L_cal2+L_cal1+L_cal3+L_cal4),:)];     video_cal_5{j}=[zeros(window_size_cal-1,num_signal_attributes+1);video((L_cal1+L_cal2+L_cal3+L_cal4+1:L_cal2+L_cal1+L_cal3+L_cal4+L_cal5),:)]; end for m=1:NumberofTrips load(strcat(rootIn,'\DataSet\synDataAll_',num2str(m))); eval(strcat('dataAll_cal_',num2str(m),'=dataAll_cal;')); end for m=1:NumberofSignalSelected     video_cal_1{m}=[video_cal_1{m},dataAll_cal_1(:,end)];     video_cal_2{m}=[video_cal_2{m},dataAll_cal_2(:,end)];     video_cal_3{m}=[video_cal_3{m},dataAll_cal_3(:,end)];     video_cal_4{m}=[video_cal_4{m},dataAll_cal_4(:,end)];     video_cal_5{m}=[video_cal_5{m},dataAll_cal_5(:,end)]; end</p><p>video=[]; video=featureAll_ECG; video_ECG_1=[zeros(window_size_ECG_raw-1,Totalfeature+1);video((1:L_ECG1),:)]; video_ECG_2=[zeros(window_size_ECG_raw-1,Totalfeature+1);video((L_ECG1+1:L_ECG2+L_ECG1),:)]; video_ECG_3=[zeros(window_size_ECG_raw-1,Totalfeature+1);video((L_ECG1+L_ECG2+1:L_ECG2+L_ECG1+L_ECG3),:)]; video_ECG_4=[zeros(window_size_ECG_raw-1,Totalfeature+1);video((L_ECG1+L_ECG2+L_ECG3+1:L_ECG2+L_ECG1+L_ECG3+L_ECG4),:)]; video_ECG_5=[zeros(window_size_ECG_raw-1,Totalfeature+1);video((L_ECG1+L_ECG2+L_ECG3+L_ECG4+1:L_ECG2+L_ECG1+L_ECG3+L_ECG4+L_ECG5),:)];</p><p>video=[]; video=featureAll_BELT; video_BELT_1=[zeros(window_size_BELT_raw-1,Totalfeature+1);video((1:L_BELT1),:)]; video_BELT_2=[zeros(window_size_BELT_raw-1,Totalfeature+1);video((L_BELT1+1:L_BELT2+L_BELT1),:)]; video_BELT_3=[zeros(window_size_BELT_raw-1,Totalfeature+1);video((L_BELT1+L_BELT2+1:L_BELT2+L_BELT1+L_BELT3),:)]; video_BELT_4=[zeros(window_size_BELT_raw-1,Totalfeature+1);video((L_BELT1+L_BELT2+L_BELT3+1:L_BELT2+L_BELT1+L_BELT3+L_BELT4),:)]; video_BELT_5=[zeros(window_size_BELT_raw-1,Totalfeature+1);video((L_BELT1+L_BELT2+L_BELT3+L_BELT4+1:L_BELT2+L_BELT1+L_BELT3+L_BELT4+L_BELT5),:)];</p><p>video_ECG_1=[zeros(window_size_ECG_raw-1,num_signal_attributes);feature_ECG_1]; video_ECG_2=[zeros(window_size_ECG_raw-1,num_signal_attributes);feature_ECG_2]; video_ECG_3=[zeros(window_size_ECG_raw-1,num_signal_attributes);feature_ECG_3]; video_ECG_4=[zeros(window_size_ECG_raw-1,num_signal_attributes);feature_ECG_4]; video_ECG_5=[zeros(window_size_ECG_raw-1,num_signal_attributes);feature_ECG_5];</p><p>video_BELT_1=[zeros(window_size_BELT_raw-1,num_signal_attributes);feature_BELT_1]; video_BELT_2=[zeros(window_size_BELT_raw-1,num_signal_attributes);feature_BELT_2]; video_BELT_3=[zeros(window_size_BELT_raw-1,num_signal_attributes);feature_BELT_3]; video_BELT_4=[zeros(window_size_BELT_raw-1,num_signal_attributes);feature_BELT_4]; video_BELT_5=[zeros(window_size_BELT_raw-1,num_signal_attributes);feature_BELT_5];</p><h2>Time Matching(generalize for ECG signals)<a name="4"></a></h2><p>[~,maxIndex]=max([size(video_ECG_1,1);size(video_ECG_2,1);size(video_ECG_3,1);size(video_ECG_4,1);size(video_ECG_5,1)]); eval(strcat('max_video_ECG=video_ECG_',num2str(maxIndex),';')); eval(strcat('max_video=video_cal_',num2str(maxIndex),'{1};')) LookUpTable=[]; for m=window_size_cal:size(max_video,1)     Time_sequence=max_video(:,1);     MatchFrom=Time_sequence(m);     [~,MatchTo_ECG]=min(abs(max_video_ECG(:,1)-MatchFrom));     LookUpTable=[LookUpTable;[m,MatchTo_ECG]]; end</p><p>Index1=find(LookUpTable(:,1)==size(video_cal_1{1},1)); NEW_ECG1=video_ECG_1(LookUpTable(1:Index1,2),2:5); NEW_ECG1=[zeros(window_size_cal-1,size(NEW_ECG1,2));NEW_ECG1];</p><p>Index2=find(LookUpTable(:,1)==size(video_cal_2{1},1)); NEW_ECG2=video_ECG_2(LookUpTable(1:Index2,2),2:5); NEW_ECG2=[zeros(window_size_cal-1,size(NEW_ECG2,2));NEW_ECG2];</p><p>Index3=find(LookUpTable(:,1)==size(video_cal_3{1},1)); NEW_ECG3=video_ECG_3(LookUpTable(1:Index3,2),2:5); NEW_ECG3=[zeros(window_size_cal-1,size(NEW_ECG3,2));NEW_ECG3];</p><p>Index4=find(LookUpTable(:,1)==size(video_cal_4{1},1)); NEW_ECG4=video_ECG_4(LookUpTable(1:Index4,2),2:5); NEW_ECG4=[zeros(window_size_cal-1,size(NEW_ECG4,2));NEW_ECG4];</p><p>Index5=find(LookUpTable(:,1)==size(video_cal_5{1},1)); NEW_ECG5=video_ECG_5(LookUpTable(1:Index5,2),2:5); NEW_ECG5=[zeros(window_size_cal-1,size(NEW_ECG5,2));NEW_ECG5];</p><p>video_cal_1=[video_cal_1,NEW_ECG1]; video_cal_2=[video_cal_2,NEW_ECG2]; video_cal_3=[video_cal_3,NEW_ECG3]; video_cal_4=[video_cal_4,NEW_ECG4]; video_cal_5=[video_cal_5,NEW_ECG5];</p><h2>Generalization for Belt signal<a name="5"></a></h2><p>[~,maxIndex]=max([size(video_BELT_1,1);size(video_BELT_2,1);size(video_BELT_3,1);size(video_BELT_4,1);size(video_BELT_5,1)]); eval(strcat('max_video_BELT=video_BELT_',num2str(maxIndex),';')); eval(strcat('max_video=video_cal_',num2str(maxIndex),'{1};')) LookUpTable=[]; for m=window_size_cal:size(max_video,1)     Time_sequence=max_video(:,1);     MatchFrom=Time_sequence(m);     [~,MatchTo_BELT]=min(abs(max_video_BELT(:,1)-MatchFrom));     LookUpTable=[LookUpTable;[m,MatchTo_BELT]]; end Index1=find(LookUpTable(:,1)==size(video_cal_1{1},1)); NEW_BELT1=video_BELT_1(LookUpTable(1:Index1,2),2:5); NEW_BELT1=[zeros(window_size_cal-1,size(NEW_BELT1,2));NEW_BELT1];</p><p>Index2=find(LookUpTable(:,1)==size(video_cal_2{1},1)); NEW_BELT2=video_ECG_2(LookUpTable(1:Index2,2),2:5); NEW_BELT2=[zeros(window_size_cal-1,size(NEW_BELT2,2));NEW_BELT2];</p><p>Index3=find(LookUpTable(:,1)==size(video_cal_3{1},1)); NEW_BELT3=video_BELT_3(LookUpTable(1:Index3,2),2:5); NEW_BELT3=[zeros(window_size_cal-1,size(NEW_BELT3,2));NEW_BELT3];</p><p>Index4=find(LookUpTable(:,1)==size(video_cal_4{1},1)); NEW_BELT4=video_BELT_4(LookUpTable(1:Index4,2),2:5); NEW_BELT4=[zeros(window_size_cal-1,size(NEW_BELT4,2));NEW_BELT4];</p><p>Index5=find(LookUpTable(:,1)==size(video_cal_5{1},1)); NEW_BELT5=video_BELT_5(LookUpTable(1:Index5,2),2:5); NEW_BELT5=[zeros(window_size_cal-1,size(NEW_BELT5,2));NEW_BELT5];</p><p>video1=[video_cal_1,NEW_BELT1]; video2=[video_cal_2,NEW_BELT2]; video3=[video_cal_3,NEW_BELT3]; video4=[video_cal_4,NEW_BELT4]; video5=[video_cal_5,NEW_BELT5];]</p><h2>Calculate the x(t)-x(t-stepsize)<a name="6"></a></h2><p>for m=1:NumberofTrips     for j=1:2       eval(strcat('signal=video',num2str(m),'{1,NumberofSignalSelected+j};'));       signal(:,5)=[0;diff(signal(:,1))];       signal(20,5)=0;       eval(strcat('video',num2str(m),'{1,NumberofSignalSelected+j}=signal;'))     end end</p><p>featureAll_ECG=[video1{:,8};video2{:,8};video3{:,8};video4{:,8};video5{:,8}];     for j=1:num_signal_attributes        featureAll_ECG(:,j)=(featureAll_ECG(:,j)-min(featureAll_ECG(:,j)))./(max(featureAll_ECG(:,j))-min(featureAll_ECG(:,j)));     end</p><p>featureAll_BELT=[video1{:,9};video2{:,9};video3{:,9};video4{:,9};video5{:,9}]; for j=1:num_signal_attributes        featureAll_BELT(:,j)=(featureAll_BELT(:,j)-min(featureAll_BELT(:,j)))./(max(featureAll_BELT(:,j))-min(featureAll_BELT(:,j))); end</p><p>L1=size(video1{1,1},1); L2=size(video2{1,1},1); L3=size(video3{1,1},1); L4=size(video4{1,1},1); L5=size(video5{1,1},1); video=[]; video=featureAll_ECG; video_ECG_1=video((1:L1),:); video_ECG_2=video((L1+1:L2+L1),:); video_ECG_3=video((L1+L2+1:L2+L1+L3),:); video_ECG_4=video((L1+L2+L3+1:L2+L1+L3+L4),:); video_ECG_5=video((L1+L2+L3+L4+1:L2+L1+L3+L4+L5),:);</p><p>video1{1,8}=video_ECG_1; video2{1,8}=video_ECG_2; video3{1,8}=video_ECG_3; video4{1,8}=video_ECG_4; video5{1,8}=video_ECG_5;</p><p>video=[]; video=featureAll_BELT; video_BELT_1=video((1:L1),:); video_BELT_2=video((L1+1:L2+L1),:); video_BELT_3=video((L1+L2+1:L2+L1+L3),:); video_BELT_4=video((L1+L2+L3+1:L2+L1+L3+L4),:); video_BELT_5=video((L1+L2+L3+L4+1:L2+L1+L3+L4+L5),:); video1{1,9}=video_BELT_1; video2{1,9}=video_BELT_2; video3{1,9}=video_BELT_3; video4{1,9}=video_BELT_4; video5{1,9}=video_BELT_5; for m=1:NumberofTrips     for j=8:9         eval(strcat('video=','video',num2str(m),'{1,j};'));         video=[zeros(size(video,1),1),video,zeros(size(video,1),1)];         eval(strcat('video',num2str(m),'{1,j}=video;'));     end end save(strcat(Outroot_origin,'\DataSet\video_final.mat'),'video1','video2','video3','video4','video5'); Extract Lane-Change period load(strcat(Outroot_origin,'\DataSet\video_final.mat')); for j=1:NumberofTrips</p><p>eval(strcat('dataAll_cell=video',num2str(j),';')); dataAll=dataAll_cell{1}; targetindex1=find(dataAll(:,end)==1); targetindex2=find(dataAll(:,end)==2); ID1=[]; ID2=[]; for m=1:length(targetindex1)-1     if(m==1)     ID1=targetindex1(1);     end     if(targetindex1(m+1)&gt;targetindex1(m)+2)     ID1=[ID1,targetindex1(m+1)];     end end for m=1:length(targetindex2)-1     if(m==1)     ID2=targetindex2(1);     end     if(targetindex2(m+1)&gt;targetindex2(m)+2)     ID2=[ID2,targetindex2(m+1)];     end end LaneChangeOldInd=ID1/10; NolangechangeInd=ID2/10; NoLane=NolangechangeInd*10+1-time_before_LC; LaneBefore=LaneChangeOldInd*10+1-time_before_LC;% at this time [x1,y1]=size(LaneBefore); [x2,y2]=size(NoLane); NumberofSignalSelected=9; for m=1:NumberofSignalSelected     eval(strcat('invoker=video',num2str(j),'{1,i};'));     for index=1:y1         pointIndex=LaneBefore(index);         middle=[middle;invoker((pointIndex:(pointIndex+lanechangesize-1)),2:6)];     end     eval(strcat('video',num2str(j),'{2,i}=middle;'));     middle=[]; end</p><p>for m=1:NumberofSignalSelected     eval(strcat('invoker=video',num2str(j),'{1,i};'));     eval(strcat('middle=video',num2str(j),'{2,i};'));     for index=1:y2         pointIndex=NoLane(index);         middle=[middle;invoker((pointIndex:(pointIndex+lanechangesize-1)),2:6)];     end     eval(strcat('video',num2str(j),'{2,i}=middle;'));     middle=[]; end end feature=[video1{2,WhichSignal};video2{2,WhichSignal};video3{2,WhichSignal};video4{2,WhichSignal};video5{2,WhichSignal}]; K1=size(video1{2,WhichSignal},1); K2=size(video2{2,WhichSignal},1); K3=size(video3{2,WhichSignal},1); K4=size(video4{2,WhichSignal},1); K5=size(video5{2,WhichSignal},1); Target=[ones(1,K1/3),zeros(1,K1*2/3),ones(1,K2/3),zeros(1,K2*2/3),ones(1,K3/3),zeros(1,K3*2/3),ones(1,K4/3),zeros(1,K4*2/3),ones(1,K5/3),zeros(1,K5*2/3)]'; save(strcat(rootIn,'\DataSet\video.mat'),'video1','video2','video3','video4','video5');</p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014b</a><br></p></div><!--
##### SOURCE BEGIN #####

    %% Combine five videos together
% load(strcat(rootIn,'\DataSet\feature_cal_1.mat'));
% feature_cal_1=Feature;
% load(strcat(rootIn,'\DataSet\feature_ECG_1.mat'));
% feature_ECG_1=Feature;
% load(strcat(rootIn,'\DataSet\feature_BELT_1.mat'));
% feature_BELT_1=Feature;
% 
% load(strcat(rootIn,'\DataSet\feature_cal_2.mat'));
% feature_cal_2=Feature;
% load(strcat(rootIn,'\DataSet\feature_ECG_2.mat'));
% feature_ECG_2=Feature;
% load(strcat(rootIn,'\DataSet\feature_BELT_2.mat'));
% feature_BELT_2=Feature;
% 
% load(strcat(rootIn,'\DataSet\feature_cal_3.mat'));
% feature_cal_3=Feature;
% load(strcat(rootIn,'\DataSet\feature_ECG_3.mat'));
% feature_ECG_3=Feature;
% load(strcat(rootIn,'\DataSet\feature_BELT_3.mat'));
% feature_BELT_3=Feature;
% 
% load(strcat(rootIn,'\DataSet\feature_cal_4.mat'));
% feature_cal_4=Feature;
% load(strcat(rootIn,'\DataSet\feature_ECG_4.mat'));
% feature_ECG_4=Feature;
% load(strcat(rootIn,'\DataSet\feature_BELT_4.mat'));
% feature_BELT_4=Feature;
% 
% load(strcat(rootIn,'\DataSet\feature_cal_5.mat'));
% feature_cal_5=Feature;
% load(strcat(rootIn,'\DataSet\feature_ECG_5.mat'));
% feature_ECG_5=Feature;
% load(strcat(rootIn,'\DataSet\feature_BELT_5.mat'));
% feature_BELT_5=Feature;

%% Normalization all together
% Normalization all together
% for m=1:NumberofSignalSelected
%     featureAll_cal{m}=[feature_cal_1{m,1};feature_cal_2{m,1};feature_cal_3{m,1};feature_cal_4{m,1};feature_cal_5{m,1}];
%     Media=featureAll_cal{m};
%     for j=2:num_signal_attributes+1
%         Media(:,j)=(Media(:,j)-min(Media(:,j)))./(max(Media(:,j))-min(Media(:,j)));
%     end
%     featureAll_cal{m}=Media;
% end
% 
% featureAll_ECG=[feature_ECG_1;feature_ECG_2;feature_ECG_3;feature_ECG_4;feature_ECG_5];
%     for j=2:Totalfeature+1
%        featureAll_ECG(:,j)=(featureAll_ECG(:,j)-min(featureAll_ECG(:,j)))./(max(featureAll_ECG(:,j))-min(featureAll_ECG(:,j)));
%     end
%     
%  
% featureAll_BELT=[feature_BELT_1;feature_BELT_2;feature_BELT_3;feature_BELT_4;feature_BELT_5];
% for j=2:Totalfeature+1
%        featureAll_BELT(:,j)=(featureAll_BELT(:,j)-min(featureAll_BELT(:,j)))./(max(featureAll_BELT(:,j))-min(featureAll_BELT(:,j)));
% end

%%  Seperate each video
% for j=1:NumberofSignalSelected
%     video=featureAll_cal{j};
%     video_cal_1{j}=[zeros(window_size_cal-1,num_signal_attributes+1);video((1:L_cal1),:)];
%     video_cal_2{j}=[zeros(window_size_cal-1,num_signal_attributes+1);video((L_cal1+1:L_cal2+L_cal1),:)];
%     video_cal_3{j}=[zeros(window_size_cal-1,num_signal_attributes+1);video((L_cal1+L_cal2+1:L_cal2+L_cal1+L_cal3),:)];
%     video_cal_4{j}=[zeros(window_size_cal-1,num_signal_attributes+1);video((L_cal1+L_cal2+L_cal3+1:L_cal2+L_cal1+L_cal3+L_cal4),:)];
%     video_cal_5{j}=[zeros(window_size_cal-1,num_signal_attributes+1);video((L_cal1+L_cal2+L_cal3+L_cal4+1:L_cal2+L_cal1+L_cal3+L_cal4+L_cal5),:)];
% end
% for m=1:NumberofTrips
% load(strcat(rootIn,'\DataSet\synDataAll_',num2str(m)));
% eval(strcat('dataAll_cal_',num2str(m),'=dataAll_cal;'));
% end
% for m=1:NumberofSignalSelected
%     video_cal_1{m}=[video_cal_1{m},dataAll_cal_1(:,end)];
%     video_cal_2{m}=[video_cal_2{m},dataAll_cal_2(:,end)];
%     video_cal_3{m}=[video_cal_3{m},dataAll_cal_3(:,end)];
%     video_cal_4{m}=[video_cal_4{m},dataAll_cal_4(:,end)];
%     video_cal_5{m}=[video_cal_5{m},dataAll_cal_5(:,end)];
% end
% 
% video=[];
% video=featureAll_ECG;
% video_ECG_1=[zeros(window_size_ECG_raw-1,Totalfeature+1);video((1:L_ECG1),:)];
% video_ECG_2=[zeros(window_size_ECG_raw-1,Totalfeature+1);video((L_ECG1+1:L_ECG2+L_ECG1),:)];
% video_ECG_3=[zeros(window_size_ECG_raw-1,Totalfeature+1);video((L_ECG1+L_ECG2+1:L_ECG2+L_ECG1+L_ECG3),:)];
% video_ECG_4=[zeros(window_size_ECG_raw-1,Totalfeature+1);video((L_ECG1+L_ECG2+L_ECG3+1:L_ECG2+L_ECG1+L_ECG3+L_ECG4),:)];
% video_ECG_5=[zeros(window_size_ECG_raw-1,Totalfeature+1);video((L_ECG1+L_ECG2+L_ECG3+L_ECG4+1:L_ECG2+L_ECG1+L_ECG3+L_ECG4+L_ECG5),:)];
% 
% video=[];
% video=featureAll_BELT;
% video_BELT_1=[zeros(window_size_BELT_raw-1,Totalfeature+1);video((1:L_BELT1),:)];
% video_BELT_2=[zeros(window_size_BELT_raw-1,Totalfeature+1);video((L_BELT1+1:L_BELT2+L_BELT1),:)];
% video_BELT_3=[zeros(window_size_BELT_raw-1,Totalfeature+1);video((L_BELT1+L_BELT2+1:L_BELT2+L_BELT1+L_BELT3),:)];
% video_BELT_4=[zeros(window_size_BELT_raw-1,Totalfeature+1);video((L_BELT1+L_BELT2+L_BELT3+1:L_BELT2+L_BELT1+L_BELT3+L_BELT4),:)];
% video_BELT_5=[zeros(window_size_BELT_raw-1,Totalfeature+1);video((L_BELT1+L_BELT2+L_BELT3+L_BELT4+1:L_BELT2+L_BELT1+L_BELT3+L_BELT4+L_BELT5),:)];
% 
% video_ECG_1=[zeros(window_size_ECG_raw-1,num_signal_attributes);feature_ECG_1];
% video_ECG_2=[zeros(window_size_ECG_raw-1,num_signal_attributes);feature_ECG_2];
% video_ECG_3=[zeros(window_size_ECG_raw-1,num_signal_attributes);feature_ECG_3];
% video_ECG_4=[zeros(window_size_ECG_raw-1,num_signal_attributes);feature_ECG_4];
% video_ECG_5=[zeros(window_size_ECG_raw-1,num_signal_attributes);feature_ECG_5];
% 
% 
% video_BELT_1=[zeros(window_size_BELT_raw-1,num_signal_attributes);feature_BELT_1];
% video_BELT_2=[zeros(window_size_BELT_raw-1,num_signal_attributes);feature_BELT_2];
% video_BELT_3=[zeros(window_size_BELT_raw-1,num_signal_attributes);feature_BELT_3];
% video_BELT_4=[zeros(window_size_BELT_raw-1,num_signal_attributes);feature_BELT_4];
% video_BELT_5=[zeros(window_size_BELT_raw-1,num_signal_attributes);feature_BELT_5];

%% Time Matching(generalize for ECG signals)
% [~,maxIndex]=max([size(video_ECG_1,1);size(video_ECG_2,1);size(video_ECG_3,1);size(video_ECG_4,1);size(video_ECG_5,1)]);
% eval(strcat('max_video_ECG=video_ECG_',num2str(maxIndex),';'));
% eval(strcat('max_video=video_cal_',num2str(maxIndex),'{1};'))
% LookUpTable=[];
% for m=window_size_cal:size(max_video,1)
%     Time_sequence=max_video(:,1);
%     MatchFrom=Time_sequence(m);
%     [~,MatchTo_ECG]=min(abs(max_video_ECG(:,1)-MatchFrom));
%     LookUpTable=[LookUpTable;[m,MatchTo_ECG]];
% end
% 
% Index1=find(LookUpTable(:,1)==size(video_cal_1{1},1));
% NEW_ECG1=video_ECG_1(LookUpTable(1:Index1,2),2:5);
% NEW_ECG1=[zeros(window_size_cal-1,size(NEW_ECG1,2));NEW_ECG1];
% 
% Index2=find(LookUpTable(:,1)==size(video_cal_2{1},1));
% NEW_ECG2=video_ECG_2(LookUpTable(1:Index2,2),2:5);
% NEW_ECG2=[zeros(window_size_cal-1,size(NEW_ECG2,2));NEW_ECG2];
% 
% Index3=find(LookUpTable(:,1)==size(video_cal_3{1},1));
% NEW_ECG3=video_ECG_3(LookUpTable(1:Index3,2),2:5);
% NEW_ECG3=[zeros(window_size_cal-1,size(NEW_ECG3,2));NEW_ECG3];
% 
% Index4=find(LookUpTable(:,1)==size(video_cal_4{1},1));
% NEW_ECG4=video_ECG_4(LookUpTable(1:Index4,2),2:5);
% NEW_ECG4=[zeros(window_size_cal-1,size(NEW_ECG4,2));NEW_ECG4];
% 
% Index5=find(LookUpTable(:,1)==size(video_cal_5{1},1));
% NEW_ECG5=video_ECG_5(LookUpTable(1:Index5,2),2:5);
% NEW_ECG5=[zeros(window_size_cal-1,size(NEW_ECG5,2));NEW_ECG5];
% 
% video_cal_1=[video_cal_1,NEW_ECG1];
% video_cal_2=[video_cal_2,NEW_ECG2];
% video_cal_3=[video_cal_3,NEW_ECG3];
% video_cal_4=[video_cal_4,NEW_ECG4];
% video_cal_5=[video_cal_5,NEW_ECG5];

%% Generalization for Belt signal
% [~,maxIndex]=max([size(video_BELT_1,1);size(video_BELT_2,1);size(video_BELT_3,1);size(video_BELT_4,1);size(video_BELT_5,1)]);
% eval(strcat('max_video_BELT=video_BELT_',num2str(maxIndex),';'));
% eval(strcat('max_video=video_cal_',num2str(maxIndex),'{1};'))
% LookUpTable=[];
% for m=window_size_cal:size(max_video,1)
%     Time_sequence=max_video(:,1);
%     MatchFrom=Time_sequence(m);
%     [~,MatchTo_BELT]=min(abs(max_video_BELT(:,1)-MatchFrom));
%     LookUpTable=[LookUpTable;[m,MatchTo_BELT]];
% end
% Index1=find(LookUpTable(:,1)==size(video_cal_1{1},1));
% NEW_BELT1=video_BELT_1(LookUpTable(1:Index1,2),2:5);
% NEW_BELT1=[zeros(window_size_cal-1,size(NEW_BELT1,2));NEW_BELT1];
% 
% Index2=find(LookUpTable(:,1)==size(video_cal_2{1},1));
% NEW_BELT2=video_ECG_2(LookUpTable(1:Index2,2),2:5);
% NEW_BELT2=[zeros(window_size_cal-1,size(NEW_BELT2,2));NEW_BELT2];
% 
% Index3=find(LookUpTable(:,1)==size(video_cal_3{1},1));
% NEW_BELT3=video_BELT_3(LookUpTable(1:Index3,2),2:5);
% NEW_BELT3=[zeros(window_size_cal-1,size(NEW_BELT3,2));NEW_BELT3];
% 
% Index4=find(LookUpTable(:,1)==size(video_cal_4{1},1));
% NEW_BELT4=video_BELT_4(LookUpTable(1:Index4,2),2:5);
% NEW_BELT4=[zeros(window_size_cal-1,size(NEW_BELT4,2));NEW_BELT4];
% 
% Index5=find(LookUpTable(:,1)==size(video_cal_5{1},1));
% NEW_BELT5=video_BELT_5(LookUpTable(1:Index5,2),2:5);
% NEW_BELT5=[zeros(window_size_cal-1,size(NEW_BELT5,2));NEW_BELT5];
% 
% video1=[video_cal_1,NEW_BELT1];
% video2=[video_cal_2,NEW_BELT2];
% video3=[video_cal_3,NEW_BELT3];
% video4=[video_cal_4,NEW_BELT4];
% video5=[video_cal_5,NEW_BELT5];]

%% Calculate the x(t)-x(t-stepsize)
% 
% for m=1:NumberofTrips
%     for j=1:2
%       eval(strcat('signal=video',num2str(m),'{1,NumberofSignalSelected+j};')); 
%       signal(:,5)=[0;diff(signal(:,1))];
%       signal(20,5)=0;
%       eval(strcat('video',num2str(m),'{1,NumberofSignalSelected+j}=signal;'))
%     end
% end
% 
% featureAll_ECG=[video1{:,8};video2{:,8};video3{:,8};video4{:,8};video5{:,8}];
%     for j=1:num_signal_attributes
%        featureAll_ECG(:,j)=(featureAll_ECG(:,j)-min(featureAll_ECG(:,j)))./(max(featureAll_ECG(:,j))-min(featureAll_ECG(:,j)));
%     end
% 
%  
% featureAll_BELT=[video1{:,9};video2{:,9};video3{:,9};video4{:,9};video5{:,9}];
% for j=1:num_signal_attributes
%        featureAll_BELT(:,j)=(featureAll_BELT(:,j)-min(featureAll_BELT(:,j)))./(max(featureAll_BELT(:,j))-min(featureAll_BELT(:,j)));
% end
% 
% L1=size(video1{1,1},1);
% L2=size(video2{1,1},1);
% L3=size(video3{1,1},1);
% L4=size(video4{1,1},1);
% L5=size(video5{1,1},1);
% video=[];
% video=featureAll_ECG;
% video_ECG_1=video((1:L1),:);
% video_ECG_2=video((L1+1:L2+L1),:);
% video_ECG_3=video((L1+L2+1:L2+L1+L3),:);
% video_ECG_4=video((L1+L2+L3+1:L2+L1+L3+L4),:);
% video_ECG_5=video((L1+L2+L3+L4+1:L2+L1+L3+L4+L5),:);
% 
% video1{1,8}=video_ECG_1;
% video2{1,8}=video_ECG_2;
% video3{1,8}=video_ECG_3;
% video4{1,8}=video_ECG_4;
% video5{1,8}=video_ECG_5;
% 
% video=[];
% video=featureAll_BELT;
% video_BELT_1=video((1:L1),:);
% video_BELT_2=video((L1+1:L2+L1),:);
% video_BELT_3=video((L1+L2+1:L2+L1+L3),:);
% video_BELT_4=video((L1+L2+L3+1:L2+L1+L3+L4),:);
% video_BELT_5=video((L1+L2+L3+L4+1:L2+L1+L3+L4+L5),:);
% video1{1,9}=video_BELT_1;
% video2{1,9}=video_BELT_2;
% video3{1,9}=video_BELT_3;
% video4{1,9}=video_BELT_4;
% video5{1,9}=video_BELT_5;
% for m=1:NumberofTrips
%     for j=8:9
%         eval(strcat('video=','video',num2str(m),'{1,j};'));
%         video=[zeros(size(video,1),1),video,zeros(size(video,1),1)];
%         eval(strcat('video',num2str(m),'{1,j}=video;'));
%     end
% end
% save(strcat(Outroot_origin,'\DataSet\video_final.mat'),'video1','video2','video3','video4','video5');
% Extract Lane-Change period
% load(strcat(Outroot_origin,'\DataSet\video_final.mat'));
% for j=1:NumberofTrips
% 
% eval(strcat('dataAll_cell=video',num2str(j),';'));
% dataAll=dataAll_cell{1};
% targetindex1=find(dataAll(:,end)==1);
% targetindex2=find(dataAll(:,end)==2);
% ID1=[];
% ID2=[];
% for m=1:length(targetindex1)-1
%     if(m==1)
%     ID1=targetindex1(1);
%     end
%     if(targetindex1(m+1)>targetindex1(m)+2)
%     ID1=[ID1,targetindex1(m+1)];
%     end
% end
% for m=1:length(targetindex2)-1
%     if(m==1)
%     ID2=targetindex2(1);
%     end
%     if(targetindex2(m+1)>targetindex2(m)+2)
%     ID2=[ID2,targetindex2(m+1)];
%     end
% end
% LaneChangeOldInd=ID1/10;
% NolangechangeInd=ID2/10;
% NoLane=NolangechangeInd*10+1-time_before_LC;
% LaneBefore=LaneChangeOldInd*10+1-time_before_LC;% at this time
% [x1,y1]=size(LaneBefore);
% [x2,y2]=size(NoLane);
% NumberofSignalSelected=9;
% for m=1:NumberofSignalSelected
%     eval(strcat('invoker=video',num2str(j),'{1,i};'));
%     for index=1:y1
%         pointIndex=LaneBefore(index);
%         middle=[middle;invoker((pointIndex:(pointIndex+lanechangesize-1)),2:6)];
%     end
%     eval(strcat('video',num2str(j),'{2,i}=middle;'));
%     middle=[];
% end
% 
% for m=1:NumberofSignalSelected
%     eval(strcat('invoker=video',num2str(j),'{1,i};'));
%     eval(strcat('middle=video',num2str(j),'{2,i};'));
%     for index=1:y2
%         pointIndex=NoLane(index); 
%         middle=[middle;invoker((pointIndex:(pointIndex+lanechangesize-1)),2:6)];
%     end
%     eval(strcat('video',num2str(j),'{2,i}=middle;'));
%     middle=[];
% end
% end
% feature=[video1{2,WhichSignal};video2{2,WhichSignal};video3{2,WhichSignal};video4{2,WhichSignal};video5{2,WhichSignal}];
% K1=size(video1{2,WhichSignal},1);
% K2=size(video2{2,WhichSignal},1);
% K3=size(video3{2,WhichSignal},1);
% K4=size(video4{2,WhichSignal},1);
% K5=size(video5{2,WhichSignal},1);
% Target=[ones(1,K1/3),zeros(1,K1*2/3),ones(1,K2/3),zeros(1,K2*2/3),ones(1,K3/3),zeros(1,K3*2/3),ones(1,K4/3),zeros(1,K4*2/3),ones(1,K5/3),zeros(1,K5*2/3)]';
% save(strcat(rootIn,'\DataSet\video.mat'),'video1','video2','video3','video4','video5');



##### SOURCE END #####
--></body></html>